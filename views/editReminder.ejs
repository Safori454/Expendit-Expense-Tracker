<!DOCTYPE html>
<html>
<head>
    <title>Edit Reminder</title>
</head>
<body>

    <h2>Edit Reminder</h2>

    <form id="editReminderForm" action="/reminders/edit/<%= reminder.id %>" method="POST">

        <label>Message:</label><br>
        <input type="text" name="message" value="<%= reminder.message %>" required><br><br>

        <label>Date:</label><br>
        <input type="date" name="date" value="<%= reminder.remind_at.toISOString().split('T')[0] %>" required><br><br>

        <label for="email">Email:</label>
        <input type="email" name="email" id="email" required value="<%= reminder.email %>"><br><br>

        <label>Time:</label><br>
        <%
            const t = new Date(reminder.remind_at)
                .toLocaleTimeString("en-GB", { hour: "2-digit", minute: "2-digit" });
        %>
        <input type="time" name="time" value="<%= t %>" required><br><br>

        <button type="submit">Save Changes</button>
    </form>

    <br>
    <form action="/reminders" method="GET">
        <button type="submit">Back</button>
    </form>

    <!-- ✅ Prevent past date/time -->
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const form = document.getElementById("editReminderForm");
            const dateInput = document.querySelector("input[name='date']");
            const timeInput = document.querySelector("input[name='time']");

            form.addEventListener("submit", (e) => {
                const date = dateInput.value;
                const time = timeInput.value;

                if (!date || !time) {
                    alert("Please choose both date and time.");
                    e.preventDefault();
                    return;
                }

                const chosen = new Date(`${date} ${time}`);
                const now = new Date();

                if (chosen <= now) {
                    e.preventDefault();
                    alert("❗ You cannot set a reminder in the past.\nPlease choose a future date and time.");
                }
            });
        });
    </script>

</body>
</html>
