<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expendit</title>
    <style>
        button { padding: 5px 10px; margin: 2px; }
    </style>
</head>
<body>
<h1>Export Your List & Send via Email</h1>

<form action="/cvtExcel/download" method="POST">
    <label for="listname">Select list to export:</label>
    <select name="listname" id="listname">
        <option value="">All Lists</option>
        <% lists.forEach(list => { %>
            <option value="<%= list.listname %>"><%= list.listname %></option>
        <% }); %>
    </select>
    <button type="submit" formaction="/cvtExcel/download">Export to Excel</button>
    <button type="submit" formaction="/export-pdf">Export to PDF</button>
</form>

<br><br>

<p>After downloading the Excel OR PDF, click the button below to open your email app and manually attach the file:</p>
<button id="openMailBtn">Open Email App</button>

<script>
document.getElementById("openMailBtn").addEventListener("click", function() {
    const subject = encodeURIComponent("Expense List Export");
    const body = encodeURIComponent("Hi,\n\nAttached is the exported expense list. Please check.\n\n- Expendit App");
    window.location.href = `mailto:?subject=${subject}&body=${body}`;
});
</script>

<br><br>

<form action="/home" method="GET">
    <button type="submit">Home</button>
</form>

</body>
</html>
