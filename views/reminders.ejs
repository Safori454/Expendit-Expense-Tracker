<%- include('partials/header', { title: 'Reminders' }) %>

<div class="page-head">
  <div>
    <h1 class="h1">Reminders</h1>
    <p class="muted">Schedule email reminders for lists and mark them as done.</p>
  </div>
  <div class="page-actions">
    <a class="btn btn-ghost" href="/home">Dashboard</a>
    <a class="btn btn-primary" href="/reminders/new">Add reminder</a>
  </div>
</div>

<div class="card">
  <div class="card-body">
    <% if (!reminders || reminders.length === 0) { %>
      <div class="alert">No reminders yet.</div>
    <% } else { %>
      <div class="table-wrap">
        <table class="table">
          <thead>
            <tr>
              <th>Message</th>
              <th>Date</th>
              <th>Time</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% reminders.forEach(r => { %>
              <tr>
                <td><%= r.message %></td>
                <td><%= new Date(r.reminder_date).toDateString() %></td>
                <td><%= r.reminder_time %></td>
                <td>
                  <% if (r.status === "sent") { %>
                    <span class="badge badge-success">Sent</span>
                  <% } else { %>
                    <span class="badge badge-warning">Pending</span>
                  <% } %>
                </td>
                <td>
                  <div class="table-actions">
                    <a class="btn btn-sm" href="/reminders/edit/<%= r.id %>">Edit</a>

                    <% if (r.status !== "sent") { %>
                      <form method="POST" action="/reminders/markdone/<%= r.id %>">
                        <button class="btn btn-primary btn-sm" type="submit">Mark done</button>
                      </form>
                    <% } %>

                    <form method="POST" action="/reminders/delete/<%= r.id %>" onsubmit="return confirm('Delete this reminder?');">
                      <button class="btn btn-danger btn-sm" type="submit">Delete</button>
                    </form>
                  </div>
                </td>
              </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
    <% } %>
  </div>
</div>

<%- include('partials/footer') %>
