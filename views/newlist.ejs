<%- include('partials/header', { title: listname }) %>

<div class="page-head">
  <div>
    <h1 class="h1"><%= listname %></h1>
    <p class="muted">Add items, review totals, and save when you’re ready.</p>
  </div>
  <div class="page-actions">
    <a class="btn btn-ghost" href="/home">Dashboard</a>
    <a class="btn btn-ghost" href="/history">History</a>
  </div>
</div>

<section class="grid grid-2">
  <div class="card">
    <div class="card-body">
      <h2 class="h2">Add item</h2>
      <form class="form" action="/additems" method="POST">
        <input type="hidden" name="listname" value="<%= listname %>" />

        <div class="field">
          <label class="label" for="itemname">Item</label>
          <input class="input" id="itemname" type="text" name="itemname" placeholder="e.g. Rice" required />
        </div>

        <div class="form-row">
          <div class="field">
            <label class="label" for="quantity">Quantity</label>
            <input class="input" id="quantity" type="number" name="quantity" placeholder="e.g. 2" min="0" step="1" required />
          </div>
          <div class="field">
            <label class="label" for="price">Price</label>
            <input class="input" id="price" type="number" step="0.01" name="price" placeholder="e.g. 12.50" min="0" required />
          </div>
        </div>

        <button class="btn btn-primary" type="submit">Add item</button>
      </form>
    </div>
  </div>
<div class="spacer-16"></div>
</section>

<section class="card">
  <div class="card-body">
    <div class="page-head">
      <div>
        <h2 class="h2">Items</h2>
        <p class="muted">Edit or remove items at any time.</p>
      </div>
    </div>

    <% if (!items || items.length === 0) { %>
      <div class="alert">
        No items yet — add your first one above.
      </div>
    <% } else { %>
      <div class="table-wrap">
        <table class="table">
          <thead>
            <tr>
              <th>Item</th>
              <th class="td-center">Qty</th>
              <th class="td-right">Price</th>
              <th class="td-right">Total</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% items.forEach(function(item) { %>
              <tr>
                <td><%= item.itemname %></td>
                <td class="td-center"><%= item.quantity %></td>
                <td class="td-right">GH₵ <%= Number(item.price).toFixed(2) %></td>
                <td class="td-right">GH₵ <%= (Number(item.quantity) * Number(item.price)).toFixed(2) %></td>
                <td>
                  <div class="table-actions">
                    <a class="btn btn-sm" href="/edititem/<%= item.id %>?listname=<%= encodeURIComponent(listname) %>">Edit</a>
                    <form action="/deleteitem" method="POST" onsubmit="return confirm('Remove this item?');">
                      <input type="hidden" name="id" value="<%= item.id %>" />
                      <input type="hidden" name="listname" value="<%= listname %>" />
                      <button class="btn btn-danger btn-sm" type="submit">Remove</button>
                    </form>
                  </div>
                </td>
              </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
    <% } %>
  </div>
</section>


<section class="grid grid-2" style="margin-top: 25px;">
  <div class="card">
    <div class="card-body">
      <h2 class="h2">Summary</h2>
      <p class="muted">Current list total</p>
      <div class="spacer-8"></div>
      <div class="h1">GH₵ <%= (total || 0).toFixed(2) %></div>
      <div class="spacer-12"></div>
      <form action="/savelist" method="POST">
        <input type="hidden" name="listname" value="<%= listname %>" />
        <button class="btn btn-primary btn-block" type="submit">Save list</button>
      </form>
    </div>
  </div>
</section>



<%- include('partials/footer') %>
